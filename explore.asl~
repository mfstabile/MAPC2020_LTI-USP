+!handleLastActionResult(ACTION,TIME)
    :   lastActionResult(success,_) & lastAction(move,_) & lastActionParams([n],_)
	<- 	-position(me,X,Y,_);
		+position(me,X,Y-1,TIME).

+!handleLastActionResult(ACTION,TIME)
    :   lastActionResult(success,_) & lastAction(move,_) & lastActionParams([s],_)
	<- 	-position(me,X,Y,_);
		+position(me,X,Y+1,TIME).
		
+!handleLastActionResult(ACTION,TIME)
    :   lastActionResult(success,_) & lastAction(move,_) & lastActionParams([e],_)
	<- 	-position(me,X,Y,_);
		+position(me,X+1,Y,TIME).
		
+!handleLastActionResult(ACTION,TIME)
    :   lastActionResult(success,_) & lastAction(move,_) & lastActionParams([w],_)
	<- 	-position(me,X,Y,_);
		+position(me,X-1,Y,TIME).
		
	///////////////////////////
+!handleLastActionResult(ACTION,TIME)
    :   lastActionResult(failed_path,_) & lastAction(move,_) & lastActionParams([n],_) & .intend(explore)
	<-  -moving(n);+moving(e);-position(me,X,Y,_);+position(me,X,Y,TIME).
	
+!handleLastActionResult(ACTION,TIME)
    :   lastActionResult(failed_path,_) & lastAction(move,_) & lastActionParams([e],_) & .intend(explore)
	<-  -moving(e);+moving(s);-position(me,X,Y,_);+position(me,X,Y,TIME).

+!handleLastActionResult(ACTION,TIME)
    :   lastActionResult(failed_path,_) & lastAction(move,_) & lastActionParams([s],_) & .intend(explore)
	<-  -moving(s);+moving(w);-position(me,X,Y,_);+position(me,X,Y,TIME).
	
+!handleLastActionResult(ACTION,TIME)
    :   lastActionResult(failed_path,_) & lastAction(move,_) & lastActionParams([w],_) & .intend(explore)
	<-  -moving(w);+moving(n);-position(me,X,Y,_);+position(me,X,Y,TIME).
///////////////////////////

+!explore : recognized(Mapps) & maxAgents(Ags) & Mapps > Ags/2 & //conhece agentes
			.count(taken(_,_,_),Tk) & Tk < Ags/2 & //poucas tasks
			task(_,_,_,_,_) & // pelo menos uma task
			thing(_,_,taskboard) & 
			.my_name(M) & available(M) & // conhece os dispensers
			goal(_,_)
	<- !!achieve.

//+!vaievolta(X0,X1,Y0,Y1) <- .print("vaievolta");!goTo(X0,Y0);!pula(4);!goTo(X1,Y1);!pula(4);!vaievolta(X0,X1,Y0,Y1).

+!pula(0)<- true.
+!pula(N)<-!performAction(skip);!pula(N-1).

+!explore : not moving(_)
<- 	+moving(n);
	!performAction(move(n));
	!explore.
	
+!explore : moving(X)
<- 	!performAction(move(X));
	.random(R);
	if (R < 0.005) { // where vl(X) is a belief
       -moving(_);+moving(n);
    }
	elif (R < 0.01) { // where vl(X) is a belief
       -moving(_);+moving(e);
    }
	elif (R < 0.015) { // where vl(X) is a belief
       -moving(_);+moving(s);
    }
	!explore.

//-!explore <- !explore.
